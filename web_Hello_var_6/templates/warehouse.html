{% extends 'base.html' %}

{% block title %}{{ page_title }}{% endblock %}

{% block content %}
    <h1>üì¶ {{ page_title }}</h1>

    <div class="stats">
        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h3>
        <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤:</strong> {{ total_products }}</p>
        <p><strong>–í—Å–µ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π:</strong> {{ total_movements }}</p>
        <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤:</strong>
            {% for category in categories %}
                {{ category.name }}{% if not forloop.last %}, {% endif %}
            {% empty %}
                –ù–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            {% endfor %}
        </p>
    </div>

    <h3>üìã –¢–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ:</h3>
    <table>
        <tr>
            <th>–§–æ—Ç–æ</th>
            <th>–¢–æ–≤–∞—Ä</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</th>  <!-- –ò–∑–º–µ–Ω–∏–ª–∏ –Ω–∞ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
        </tr>
        {% for product in products %}
        <tr>
            <td>
                {% if product.photo %}
                    <img src="{{ product.photo.url }}" alt="{{ product.name }}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px;">
                {% else %}
                    <div style="width: 50px; height: 50px; background: #f0f0f0; display: flex; align-items: center; justify-content: center; border-radius: 4px;">
                        üì∑
                    </div>
                {% endif %}
            </td>
            <td>{{ product.name }}</td>
            <td>{{ product.price }} —Ä—É–±.</td>
            <td>
                {% for pc in product.productcategory_set.all %}
                    <span style="background: #007bff; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px; margin: 1px;">
                        {{ pc.category.name }}
                    </span>
                {% empty %}
                    <span style="color: #999;">–ù–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π</span>
                {% endfor %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" style="text-align: center;">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</td>
        </tr>
        {% endfor %}
    </table>

    <h3>üöö –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è:</h3>
    <table>
        <tr>
            <th>–¢–æ–≤–∞—Ä</th>
            <th>–ú–∞–≥–∞–∑–∏–Ω</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
            <th>–î–∞—Ç–∞</th>
        </tr>
        {% for movement in movements %}
        <tr>
            <td>{{ movement.product.name }}</td>
            <td>{{ movement.store }}</td>
            <td>{{ movement.quantity }} —à—Ç.</td>
            <td>{{ movement.date }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" style="text-align: center;">–ù–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π</td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}```
